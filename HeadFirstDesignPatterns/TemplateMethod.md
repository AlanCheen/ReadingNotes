# 模板方法模式

模板方法模式： **在一个方法中定义一个算法的估价，而将一些步骤延迟到子类中。模板方法使得子类可以在不改变方法结构的情况下，重新定义算法的某些步骤。**  


![类图](http://ww4.sinaimg.cn/large/98900c07jw1f61gfmlicej20s40p2ae6.jpg)


具体来说：

创建一个算法的模板，这个模板其实就是第一个方法(需要定义为`final`)。而这个方法将算法定义成一组步骤，其中的任何步骤都可以是抽象的，由子类负责实现。这样可以确保算法结构保持不变，同时由子类提供部分实现。  


模板方法模式用来封装算法。


## Hook

BONUS TIME！  

`hook()`(钩子)指那些 『默认不做事的方法』，子类可以视情况决定要不要覆盖它们。  

**钩子** 是 『一种被声明在抽象类中的方法，但只有空的或者默认的实现』。

钩子的存在，可以让子类有能力对算法的不同点就行挂钩。要不要挂钩，由子类自行决定。  

其实Hook并不高端，在实际中有很多运用，比如在`BaseActivity`里配置一些东西的时候，留几个有默认返回值的方法做为某个功能的开关，比如：是否能侧滑返回等。  


```java
//...
if（canSwipeBack()）{
  setupSwipeBack();
}
//...
protected boolean canSwipeBack(){
  return true;
}
```

### Hook 的用法&目的

1. Hook可以让子类实现算法中的『可选』部分。  
2. 让子类有机会对模板方法中某些即将发生的(或刚刚发生的)步骤做出反应。    
3. 钩子也可以让子类有能力为其抽象类做一些决定。  



Java中数组的 `Arrays.sort([])` 方法就是模板方法。  

## 要点

1. 模板方法定义了算法的步骤，把这些步骤的实现延迟到了子类。  
2. 模板方法为我们提供了一种代码复用的重要技巧。  
3. 模板方法的抽象类可以定义具体方法、抽象方法和钩子。  
4. 抽象方法由子类实现。  
5. 钩子是一种方法，它在抽象类中不做事，或者只做默认的事情，子类可以选择要不要去覆盖它。
6. 为了防止子类改变模板方法中的算法，可以将模板方法声明为`final`
7. 好莱坞原则告诉我们，将决策权放在高层模块中，以便决定如何以及何时调用低层模块。  
8. 你将在真实世界代码中看到模板方法模式的许多变体，不要期待它们全都是一眼就可以被你认出的。
9. 策略模式和模板模式都封装算法，一个用组合，一个用继承。  
10. 工厂方法是模板方法的一个特殊版本。  

## 小结

模板方法更侧重在『模板』二字，它需要做的是定义一个算法的『大纲』，它的子类去实现的是这个『大纲』里的几个步骤，算法的结构维持不变。  

模板方法对算法的控制权更大一些，但是由于模板方法使用的是 继承，并且父类中有实现，所以子类会依赖父类中的实现，缺乏了点弹性。  
